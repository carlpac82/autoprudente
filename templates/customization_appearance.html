<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Appearance Settings</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="/static/i18n.js"></script>
    <script src="/static/auto-sync.js"></script>
    <script src="/static/branding.js"></script>
    <script src="/static/notifications.js"></script>
    <style>
        * { font-family: 'Outfit', sans-serif; }
    </style>
</head>
<body class="bg-gray-50 p-6">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white shadow rounded-lg p-6">
            <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 text-[#009cb6]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
                </svg>
                <span data-i18n="appearance.title">Theme & Colors</span>
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="appearance.primaryColor">Primary Color</label>
                    <div class="flex gap-2">
                        <input type="color" id="primaryColor" value="#009cb6" class="h-10 w-20 border border-gray-300 rounded cursor-pointer">
                        <input type="text" id="primaryColorHex" value="#009cb6" class="flex-1 px-3 py-2 border border-gray-300 focus:ring-2 focus:ring-[#009cb6] focus:border-transparent rounded font-mono text-sm">
                    </div>
                    <p class="text-xs text-gray-500 mt-1" data-i18n="appearance.primaryDesc">Main brand color (buttons, links, accents)</p>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="appearance.secondaryColor">Secondary Color</label>
                    <div class="flex gap-2">
                        <input type="color" id="secondaryColor" value="#f4ad0f" class="h-10 w-20 border border-gray-300 rounded cursor-pointer">
                        <input type="text" id="secondaryColorHex" value="#f4ad0f" class="flex-1 px-3 py-2 border border-gray-300 focus:ring-2 focus:ring-[#009cb6] focus:border-transparent rounded font-mono text-sm">
                    </div>
                    <p class="text-xs text-gray-500 mt-1" data-i18n="appearance.secondaryDesc">Secondary accent color (highlights, hover states)</p>
                </div>
            </div>

            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-3">Color Preview</label>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="p-4 rounded border border-gray-200 text-center">
                        <div id="previewPrimary" class="h-16 rounded mb-2" style="background-color: #009cb6;"></div>
                        <p class="text-xs text-gray-600">Primary</p>
                    </div>
                    <div class="p-4 rounded border border-gray-200 text-center">
                        <div id="previewSecondary" class="h-16 rounded mb-2" style="background-color: #f4ad0f;"></div>
                        <p class="text-xs text-gray-600">Secondary</p>
                    </div>
                    <div class="p-4 rounded border border-gray-200 text-center">
                        <button id="previewButton" class="px-4 py-2 text-white rounded text-sm" style="background-color: #009cb6;">Button</button>
                        <p class="text-xs text-gray-600 mt-2">Primary Button</p>
                    </div>
                    <div class="p-4 rounded border border-gray-200 text-center">
                        <button id="previewButtonHover" class="px-4 py-2 text-white rounded text-sm" style="background-color: #f4ad0f;">Hover</button>
                        <p class="text-xs text-gray-600 mt-2">Hover State</p>
                    </div>
                </div>
            </div>

            <div class="bg-[#f0f9fb] border border-[#009cb6] rounded p-4">
                <div class="flex items-start gap-3">
                    <svg class="w-5 h-5 text-[#009cb6] flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    <div>
                        <p class="text-sm text-gray-800"><strong class="text-[#009cb6]">Note:</strong> Color changes will be applied across the entire platform. Make sure to test thoroughly after changing colors.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function loadSettings() {
            const saved = localStorage.getItem('brandingSettings');
            if (saved) {
                try {
                    const settings = JSON.parse(saved);
                    if (settings.primaryColor) {
                        document.getElementById('primaryColor').value = settings.primaryColor;
                        document.getElementById('primaryColorHex').value = settings.primaryColor;
                        updateColorPreview();
                    }
                    if (settings.secondaryColor) {
                        document.getElementById('secondaryColor').value = settings.secondaryColor;
                        document.getElementById('secondaryColorHex').value = settings.secondaryColor;
                        updateColorPreview();
                    }
                } catch (e) {
                    console.error('Error loading settings:', e);
                }
            }
        }

        function saveSettings() {
            const saved = localStorage.getItem('brandingSettings') || '{}';
            const settings = JSON.parse(saved);
            
            settings.primaryColor = document.getElementById('primaryColor').value;
            settings.secondaryColor = document.getElementById('secondaryColor').value;
            
            localStorage.setItem('brandingSettings', JSON.stringify(settings));
            window.dispatchEvent(new Event('brandingUpdated'));
            if (typeof window.applyBranding === 'function') window.applyBranding();
            showNotification('âœ… Colors saved and applied!', 'success');
        }

        function updateColorPreview() {
            const primary = document.getElementById('primaryColor').value;
            const secondary = document.getElementById('secondaryColor').value;
            
            document.getElementById('previewPrimary').style.backgroundColor = primary;
            document.getElementById('previewSecondary').style.backgroundColor = secondary;
            document.getElementById('previewButton').style.backgroundColor = primary;
            document.getElementById('previewButtonHover').style.backgroundColor = secondary;
        }

        // showNotification is now loaded from /static/notifications.js

        document.getElementById('primaryColor').addEventListener('input', (e) => {
            document.getElementById('primaryColorHex').value = e.target.value;
            updateColorPreview();
            saveSettings();
        });
        
        document.getElementById('primaryColorHex').addEventListener('input', (e) => {
            if (/^#[0-9A-F]{6}$/i.test(e.target.value)) {
                document.getElementById('primaryColor').value = e.target.value;
                updateColorPreview();
                saveSettings();
            }
        });
        
        document.getElementById('secondaryColor').addEventListener('input', (e) => {
            document.getElementById('secondaryColorHex').value = e.target.value;
            updateColorPreview();
            saveSettings();
        });
        
        document.getElementById('secondaryColorHex').addEventListener('input', (e) => {
            if (/^#[0-9A-F]{6}$/i.test(e.target.value)) {
                document.getElementById('secondaryColor').value = e.target.value;
                updateColorPreview();
                saveSettings();
            }
            document.addEventListener('DOMContentLoaded', function() {
                loadSettings();
                // Apply translations
                if (typeof applyTranslations === 'function') {
                    applyTranslations();
                }
            });
        });

    </script>
</body>
</html>
