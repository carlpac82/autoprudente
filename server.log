WARNING:root:‚ö†Ô∏è  Sentry SDK not installed - monitoring disabled
/Users/filipepacheco/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
/Users/filipepacheco/CascadeProjects/RentalPriceTrackerPerDay/main.py:588: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
/Users/filipepacheco/CascadeProjects/RentalPriceTrackerPerDay/main.py:10175: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [68964]
INFO:     Waiting for application startup.
========================================
üöÄ APP STARTUP - Rental Price Tracker
========================================
üìä Initializing database tables...
   ‚úÖ users table created/exists
üë• Creating default users...
‚úÖ Default users ready (admin/admin)
========================================
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
[API] REQUEST: location=Faro, start_date=2025-11-11, start_time=15:00, days=0
[DATE_ROTATION] Erro ao carregar configura√ß√µes: no such column: setting_value
[DATE_ROTATION] Original: 2025-11-11, Rotated: 2025-11-14 (+3 days)
[API] COMPUTED: start_dt=2025-11-14, end_dt=2025-11-19, days=5
[POST_DIRETO] Tentando POST direto ao Carjet...
/Users/filipepacheco/CascadeProjects/RentalPriceTrackerPerDay/main.py:7138: DeprecationWarning: The 'text' argument to find()-type methods is deprecated. Use 'string' instead.
  for el in soup.find_all(text=price_regex):
[POST_DIRETO] ‚ö†Ô∏è Falhou ou retornou 0 items, continuando para SELENIUM...
[POST_DIRETO] ‚ö†Ô∏è Retornou 0 items, continuando para SELENIUM...
[SELENIUM] Iniciando scraping SIMPLES (igual ao teste) para Faro
[SELENIUM_SIMPLE] Iniciando scraping...
[SELENIUM_SIMPLE] Local: Faro Aeroporto (FAO)
[SELENIUM_SIMPLE] Datas: 14/11/2025 - 19/11/2025
[SELENIUM_SIMPLE] Modo headless (invis√≠vel)
[SELENIUM_SIMPLE] Navegando para https://www.carjet.com/aluguel-carros/index.htm
[SELENIUM_SIMPLE] ‚úÖ Cookies rejeitados
[SELENIUM_SIMPLE] PASSO 1: Escrevendo local...
[SELENIUM_SIMPLE] ‚úì Local digitado
[SELENIUM_SIMPLE] PASSO 2: Aguardando dropdown...
[SELENIUM_SIMPLE] ‚úÖ Dropdown clicado
[SELENIUM_SIMPLE] PASSO 3: Preenchendo datas e horas...
[SELENIUM_SIMPLE] ‚úì Datas preenchidas: {'allFilled': True, 'fechaDevolucion': True, 'fechaRecogida': True, 'horaDevolucion': True, 'horaRecogida': True}
[SELENIUM_SIMPLE] PASSO 4: Submetendo...
[SELENIUM_SIMPLE] Aguardando navega√ß√£o...
[SELENIUM_SIMPLE] Aguardando p√°gina de resultados...
[SELENIUM_SIMPLE] ‚úÖ P√°gina carregada ap√≥s 0s
[SELENIUM_SIMPLE] URL final: https://www.carjet.com/do/list/pt?s=729b9bbb-086c-4b54-bb34-e25617aac26e&b=0ed7aaab-92d1-4a43-84c6-debb21c299f7
[SELENIUM_SIMPLE] ‚úÖ Sucesso! HTML: 1119084 bytes
[SELENIUM] ‚úÖ Scraping simples bem-sucedido!
[SELENIUM] Fazendo parse de 1119084 bytes...
[SELENIUM] Parsed 278 items
[SELENIUM] 278 ap√≥s GBP‚ÜíEUR
[SELENIUM] 278 ap√≥s ajustes
[SELENIUM] ‚úÖ 278 carros encontrados!
[DEBUG] Primeiro item: cat=Mini, car_clean=Fiat 500, group=B1
[DEBUG] row tem 'group'? True, valor=B1

============================================================
[API] REQUEST: location=Faro, start_date=2025-11-11, start_time=15:00, days=0
[API] end_date_in=2025-11-19, end_time=15:00
============================================================

[API] COMPUTED: start_dt=2025-11-14, end_dt=2025-11-19, days=5
[PARSE] Found 0 cards to parse
[PARSE] Stats: price=0, name=0, blocked=0, items=0
[DEBUG] TEST_MODE_LOCAL=0, location=faro, days=5
[PARSE] Found 278 cards to parse
[PARSE] Stats: price=278, name=278, blocked=0, items=278
[PARSE] Returning 278 items from card parsing
INFO:     127.0.0.1:62142 - "POST /api/track-by-params HTTP/1.1" 200 OK
INFO:     127.0.0.1:62282 - "GET / HTTP/1.1" 303 See Other
INFO:     127.0.0.1:62282 - "GET /login HTTP/1.1" 200 OK
INFO:     127.0.0.1:62282 - "POST /login HTTP/1.1" 303 See Other
INFO:     127.0.0.1:62282 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:62282 - "GET /healthz HTTP/1.1" 200 OK
[API] REQUEST: location=Aeroporto de Faro, start_date=2025-11-14, start_time=15:00, days=7
[DATE_ROTATION] Erro ao carregar configura√ß√µes: no such column: setting_value
[DATE_ROTATION] Original: 2025-11-14, Rotated: 2025-11-15 (+1 days)
[API] COMPUTED: start_dt=2025-11-15, end_dt=2025-11-22, days=7
[POST_DIRETO] Tentando POST direto ao Carjet...
[POST_DIRETO] ‚ö†Ô∏è Falhou ou retornou 0 items, continuando para SELENIUM...
[POST_DIRETO] ‚ö†Ô∏è Retornou 0 items, continuando para SELENIUM...
[SELENIUM] Iniciando scraping SIMPLES (igual ao teste) para Aeroporto de Faro
[SELENIUM_SIMPLE] Iniciando scraping...
[SELENIUM_SIMPLE] Local: Faro Aeroporto (FAO)
[SELENIUM_SIMPLE] Datas: 15/11/2025 - 22/11/2025
[SELENIUM_SIMPLE] Modo headless (invis√≠vel)
[SELENIUM_SIMPLE] Navegando para https://www.carjet.com/aluguel-carros/index.htm
[SELENIUM_SIMPLE] ‚úÖ Cookies rejeitados
[SELENIUM_SIMPLE] PASSO 1: Escrevendo local...
[SELENIUM_SIMPLE] ‚úì Local digitado
[SELENIUM_SIMPLE] PASSO 2: Aguardando dropdown...
[SELENIUM_SIMPLE] ‚úÖ Dropdown clicado
[SELENIUM_SIMPLE] PASSO 3: Preenchendo datas e horas...
[SELENIUM_SIMPLE] ‚úì Datas preenchidas: {'allFilled': True, 'fechaDevolucion': True, 'fechaRecogida': True, 'horaDevolucion': True, 'horaRecogida': True}
[SELENIUM_SIMPLE] PASSO 4: Submetendo...
[SELENIUM_SIMPLE] Aguardando navega√ß√£o...
[SELENIUM_SIMPLE] Aguardando p√°gina de resultados...
[SELENIUM_SIMPLE] ‚úÖ P√°gina carregada ap√≥s 0s
[SELENIUM_SIMPLE] URL final: https://www.carjet.com/do/list/pt?s=29d2cab6-9cf9-482a-a900-4bf592b5e98d&b=272863b4-86f9-40f0-bfac-ac55e7afa51c
[SELENIUM_SIMPLE] ‚úÖ Sucesso! HTML: 1108332 bytes
[SELENIUM] ‚úÖ Scraping simples bem-sucedido!
[SELENIUM] Fazendo parse de 1108332 bytes...
[SELENIUM] Parsed 275 items
[SELENIUM] 275 ap√≥s GBP‚ÜíEUR
[SELENIUM] 275 ap√≥s ajustes
[SELENIUM] ‚úÖ 275 carros encontrados!
[DEBUG] Primeiro item: cat=Mini, car_clean=Fiat 500, group=B1
[DEBUG] row tem 'group'? True, valor=B1

============================================================
[API] REQUEST: location=Aeroporto de Faro, start_date=2025-11-14, start_time=15:00, days=7
[API] end_date_in=, end_time=15:00
============================================================

[API] COMPUTED: start_dt=2025-11-15, end_dt=2025-11-22, days=7
[PARSE] Found 0 cards to parse
[PARSE] Stats: price=0, name=0, blocked=0, items=0
[DEBUG] TEST_MODE_LOCAL=0, location=aeroporto de faro, days=7
[PARSE] Found 275 cards to parse
[PARSE] Stats: price=275, name=275, blocked=0, items=275
[PARSE] Returning 275 items from card parsing
INFO:     127.0.0.1:62299 - "POST /api/track-by-params HTTP/1.1" 200 OK
INFO:     127.0.0.1:50046 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:50046 - "GET /healthz HTTP/1.1" 200 OK
[API] REQUEST: location=Aeroporto de Faro, start_date=2025-11-06, start_time=15:00, days=7
[DATE_ROTATION] Erro ao carregar configura√ß√µes: no such column: setting_value
[DATE_ROTATION] Original: 2025-11-06, Rotated: 2025-11-09 (+3 days)
[API] COMPUTED: start_dt=2025-11-09, end_dt=2025-11-16, days=7
[POST_DIRETO] Tentando POST direto ao Carjet...
[POST_DIRETO] ‚ö†Ô∏è Falhou ou retornou 0 items, continuando para SELENIUM...
[POST_DIRETO] ‚ö†Ô∏è Retornou 0 items, continuando para SELENIUM...
[SELENIUM] Iniciando scraping SIMPLES (igual ao teste) para Aeroporto de Faro
[SELENIUM_SIMPLE] Iniciando scraping...
[SELENIUM_SIMPLE] Local: Faro Aeroporto (FAO)
[SELENIUM_SIMPLE] Datas: 09/11/2025 - 16/11/2025
[SELENIUM_SIMPLE] Modo headless (invis√≠vel)
[SELENIUM_SIMPLE] Navegando para https://www.carjet.com/aluguel-carros/index.htm
[SELENIUM_SIMPLE] ‚úÖ Cookies rejeitados
[SELENIUM_SIMPLE] PASSO 1: Escrevendo local...
[SELENIUM_SIMPLE] ‚úì Local digitado
[SELENIUM_SIMPLE] PASSO 2: Aguardando dropdown...
[SELENIUM_SIMPLE] ‚úÖ Dropdown clicado
[SELENIUM_SIMPLE] PASSO 3: Preenchendo datas e horas...
[SELENIUM_SIMPLE] ‚úì Datas preenchidas: {'allFilled': True, 'fechaDevolucion': True, 'fechaRecogida': True, 'horaDevolucion': True, 'horaRecogida': True}
[SELENIUM_SIMPLE] PASSO 4: Submetendo...
[SELENIUM_SIMPLE] Aguardando navega√ß√£o...
[SELENIUM_SIMPLE] Aguardando p√°gina de resultados...
[SELENIUM_SIMPLE] ‚úÖ P√°gina carregada ap√≥s 0s
[SELENIUM_SIMPLE] URL final: https://www.carjet.com/do/list/pt?s=e156dd13-a0fd-42f8-8d92-fd1367b881a0&b=d91207db-0cbc-4776-98ca-184ef494d80a
[SELENIUM_SIMPLE] ‚úÖ Sucesso! HTML: 1115379 bytes
[SELENIUM] ‚úÖ Scraping simples bem-sucedido!
[SELENIUM] Fazendo parse de 1115379 bytes...
[SELENIUM] Parsed 277 items
[SELENIUM] 277 ap√≥s GBP‚ÜíEUR
[SELENIUM] 277 ap√≥s ajustes
[SELENIUM] ‚úÖ 277 carros encontrados!
[DEBUG] Primeiro item: cat=Economy, car_clean=Opel Corsa, group=D
[DEBUG] row tem 'group'? True, valor=D

============================================================
[API] REQUEST: location=Aeroporto de Faro, start_date=2025-11-06, start_time=15:00, days=7
[API] end_date_in=, end_time=15:00
============================================================

[API] COMPUTED: start_dt=2025-11-09, end_dt=2025-11-16, days=7
[PARSE] Found 0 cards to parse
[PARSE] Stats: price=0, name=0, blocked=0, items=0
[DEBUG] TEST_MODE_LOCAL=0, location=aeroporto de faro, days=7
[PARSE] Found 277 cards to parse
[PARSE] Stats: price=277, name=277, blocked=0, items=277
[PARSE] Returning 277 items from card parsing
INFO:     127.0.0.1:50053 - "POST /api/track-by-params HTTP/1.1" 200 OK
INFO:     127.0.0.1:50046 - "GET /static/logos/logo_SXT.png HTTP/1.1" 304 Not Modified
